<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        
        <meta charset="UTF-8">
        <title>Design Your Own REST API | XBRL Tutorial</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="28msec">
        <meta name="description" content="This tutorial is up-to-date against the 3.4 Irvine release, published on May 20th, 2014.">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        
        <link rel="prev" href="../gitbook/chap-BizQLTutorial-ReportSchemas.html" />
        

        <meta property="og:title" content="Design Your Own REST API | XBRL Tutorial">
        <meta property="og:site_name" content="XBRL Tutorial">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/28msec">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
        
    </head>
    <body>
        
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="28msec/xbrl-tutorial" data-level="8" data-basepath=".." data-revision="1404471387692">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/28msec/xbrl-tutorial" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/28msec/xbrl-tutorial/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/28msec/xbrl-tutorial/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >XBRL Tutorial</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/28msec" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/28msec/xbrl-tutorial/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/28msec/xbrl-tutorial/edit/master/gitbook/chap-BizQLTutorial-DesignYourOwnRESTAPI.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
    
        <li class="chapter " data-level="1" data-path="gitbook/chap-BizQLTutorial-Introduction.html">
            
            <a href="../gitbook/chap-BizQLTutorial-Introduction.html">
                <i class="fa fa-check"></i> <b>1.</b> Introduction
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="gitbook/chap-BizQLTutorial-Companies.html">
            
            <a href="../gitbook/chap-BizQLTutorial-Companies.html">
                <i class="fa fa-check"></i> <b>2.</b> Companies
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="gitbook/chap-BizQLTutorial-Filings.html">
            
            <a href="../gitbook/chap-BizQLTutorial-Filings.html">
                <i class="fa fa-check"></i> <b>3.</b> Filings
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="gitbook/chap-BizQLTutorial-Networks.html">
            
            <a href="../gitbook/chap-BizQLTutorial-Networks.html">
                <i class="fa fa-check"></i> <b>4.</b> Networks
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="gitbook/chap-BizQLTutorial-FactTables.html">
            
            <a href="../gitbook/chap-BizQLTutorial-FactTables.html">
                <i class="fa fa-check"></i> <b>5.</b> Fact tables
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="gitbook/chap-BizQLTutorial-Hypercubes.html">
            
            <a href="../gitbook/chap-BizQLTutorial-Hypercubes.html">
                <i class="fa fa-check"></i> <b>6.</b> Hypercube Querying
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="gitbook/chap-BizQLTutorial-ReportSchemas.html">
            
            <a href="../gitbook/chap-BizQLTutorial-ReportSchemas.html">
                <i class="fa fa-check"></i> <b>7.</b> Report schemas
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="gitbook/chap-BizQLTutorial-DesignYourOwnRESTAPI.html">
            
            <a href="../gitbook/chap-BizQLTutorial-DesignYourOwnRESTAPI.html">
                <i class="fa fa-check"></i> <b>8.</b> Design Your Own REST API
            </a>
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 100%;min-width: 87.5%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../gitbook/chap-BizQLTutorial-Introduction.html" title="Introduction" class="chapter done new-chapter" data-progress="1" style="left: 12.5%;"></a>
    
        <a href="../gitbook/chap-BizQLTutorial-Companies.html" title="Companies" class="chapter done new-chapter" data-progress="2" style="left: 25%;"></a>
    
        <a href="../gitbook/chap-BizQLTutorial-Filings.html" title="Filings" class="chapter done new-chapter" data-progress="3" style="left: 37.5%;"></a>
    
        <a href="../gitbook/chap-BizQLTutorial-Networks.html" title="Networks" class="chapter done new-chapter" data-progress="4" style="left: 50%;"></a>
    
        <a href="../gitbook/chap-BizQLTutorial-FactTables.html" title="Fact tables" class="chapter done new-chapter" data-progress="5" style="left: 62.5%;"></a>
    
        <a href="../gitbook/chap-BizQLTutorial-Hypercubes.html" title="Hypercube Querying" class="chapter done new-chapter" data-progress="6" style="left: 75%;"></a>
    
        <a href="../gitbook/chap-BizQLTutorial-ReportSchemas.html" title="Report schemas" class="chapter done new-chapter" data-progress="7" style="left: 87.5%;"></a>
    
        <a href="../gitbook/chap-BizQLTutorial-DesignYourOwnRESTAPI.html" title="Design Your Own REST API" class="chapter done new-chapter" data-progress="8" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_3">
                    
                        <h1 id="design-your-own-rest-api">Design Your Own REST API</h1>
<p>If the above REST API does not cover your needs, you can design your own REST API.</p>
<h2 id="getting-the-parameters-from-the-query-string">Getting the parameters from the query string</h2>
<p>We now explain how to do a simple API for just retrieve a company with its ticker.</p>
<p>The first thing you need to know is that, whenever you write a public query, its results becomes available through a REST call.</p>
<p> <a href="http://project-name.xbrl.io/my-query.jq" target="_blank">http://project-name.xbrl.io/my-query.jq</a></p>
<p>For example, you can call the query returning all entities with the following URI:</p>
<p> <a href="http://project-name.xbrl.io/companies/all.jq" target="_blank">http://project-name.xbrl.io/companies/all.jq</a></p>
<p>For more elaborate queries though, the following endpoint is better suited:</p>
<p> <a href="http://project-name.xbrl.io/v1/_queries/public/companies/all.jq" target="_blank">http://project-name.xbrl.io/v1/_queries/public/companies/all.jq</a></p>
<p>However, it is more strict, meaning that it will complain if the query has side effects and if the method is GET -- you have to use POST for side-effecting queries.</p>
<p>Finally, this more elaborate endpoint is stricter about types, meaning, you need to use a function to declare the type of what the query returns.</p>
<p>For the sake of simplicity, we use the simpler endpoint in ths rest of this chapter.</p>
<h2 id="useful-functions">Useful functions</h2>
<p>You will need to read parameters from the query string. There is a function named parameter-values, which lives in the<a href="http://www.28msec.com/modules/http-requestnamespace" target="_blank">http://www.28msec.com/modules/http-requestnamespace</a>. It takes a parameter name, and returns the sequence of all its values (it may have several if it appears several times in the request URL).</p>
<p> Example - Read a parameter&#39;s value(s) from the query string</p>
<pre><code class="lang-jsoniq">import module namespace companies =
    &quot;http://xbrl.io/modules/bizql/profiles/sec/companies&quot;;
import module namespace request =
    &quot;http://www.28msec.com/modules/http/request&quot;;

let $tickers := request:parameter-values(&quot;t&quot;)
return companies:companies-for-tickers($tickers)
</code></pre>
<p>Here is a possible way to invoke this query via the REST API:</p>
<p>GET <a href="http://project-name.xbrl.io/rest-api/query-string-parameter.jq?t=wmt&amp;t=GOOG" target="_blank">http://project-name.xbrl.io/rest-api/query-string-parameter.jq?t=wmt&amp;t=GOOG</a></p>
<p>There are a few more useful functions. For example,request:method-get(),method-post(), etc, return a boolean and allow you to know which method the consumer used.</p>
<p>Until now, we used the request module. Likewise, there is a response module<a href="http://www.28msec.com/modules/http-response" target="_blank">http://www.28msec.com/modules/http-response</a>, with which you can tune the output (HTTP code, MIME type, etc).</p>
<p> Example - Read a parameter&#39;s value(s) from the query string</p>
<pre><code class="lang-jsoniq">import module namespace companies =
    &quot;http://xbrl.io/modules/bizql/profiles/sec/companies&quot;;
import module namespace request =
    &quot;http://www.28msec.com/modules/http-request&quot;;
import module namespace response =
    &quot;http://www.28msec.com/modules/http-response&quot;;

let $tickers := request:param-values(&quot;t&quot;)
return switch(true)
        case request:method-get() and exists($tickers)
        return {
          response:content-type(&quot;application/json&quot;);
          companies:companies-for-tickers($tickers)
        }
        case request:method-get() and empty($tickers)
        return {
          response:status-code(404);
          ()
        }
        default return {
          response:content-type(&quot;text/plain&quot;);
          &quot;Method not supported.&quot;
        }
</code></pre>
<p>The above query reacts on the method and on whether companies are found to demonstrate a few of the available features:</p>
<ol>
<li>If the method is GET and facts are found, it returns them as JSON. GET <a href="http://project-name.xbrl.io/rest/more-methods.jq?t=wmt&amp;t=GOOG" target="_blank">http://project-name.xbrl.io/rest/more-methods.jq?t=wmt&amp;t=GOOG</a></li>
<li>If the method is GET and no facts are found, it returns a 404 NOT FOUND. GET <a href="http://project-name.xbrl.io/rest/more-methods.jq?t=dummy" target="_blank">http://project-name.xbrl.io/rest/more-methods.jq?t=dummy</a></li>
<li>If the method is different, it returns a message in plain text. DELETE <a href="http://project-name.xbrl.io/rest/more-methods.jq?t=wmt&amp;t=GOOG" target="_blank">http://project-name.xbrl.io/rest/more-methods.jq?t=wmt&amp;t=GOOG</a>##That&#39;s it for now!
With these building blocks, and together with the 28.io platform and modules documentation, you are all set! Do not hesitate to ask questions on our Zendesk support platform. We&#39;ll be very happy to assist you.</li>
</ol>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../gitbook/chap-BizQLTutorial-ReportSchemas.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Report schemas"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
